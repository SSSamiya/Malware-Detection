from USstrings import *
import struct
import sys
import base64
import pefile

FILE_PATH = sys.argv[1]

config = {
    1 : "Install Directory",
    2 : "Install Name",
    3 : "Host",
    5 : "Port",
    9 : "Compaign ID",
    10 : "Version"
}
def isBase64(string):
    try:
        if(base64.b64encode(base64.b64decode(string)) == string):
            return True
        else:
            return False
    except:
        pass

if __name__ == "__main__":
    try:
        data = []
        data = get_US_strings(FILE_PATH)
        #print(*data, sep="\n")

        for k, values in config.items():
            try:
                if(k != 9): 
                    print("{} : {}".format(values, data[k].decode()))
                else:
                    if(isBase64(data[k])):
                        id = base64.b64decode(data[k])
                        print("{} : {}".format(values, id.decode()))
            except:
                pass

    except Exception as e:
        print(e)